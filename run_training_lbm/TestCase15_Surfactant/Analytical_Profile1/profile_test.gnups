set terminal postscript enhanced solid color "Times-Roman,20"
set xlabel "X"
set ylabel "Compos"
set datafile separator ","
set grid
##############################################
W = 8.0
eps=  27.76590723574115
k =  1.110636289429646
beta = 1.0
#max_G = -beta*k*(4*eps/(k*(W**2)) +1)/8
valbulk = 0.0005

cb = valbulk/(1-valbulk)

phi(x) = 0.5*(1+tanh(-2*x/W))
dphidx(x) = 4*phi(x)*(1-phi(x))/W
G(x) = -0.5*eps*(dphidx(x)**2)+0.5*k*phi(x)*(phi(x)-1)
comp(x) = cb/(cb + exp(beta*G(x)))
################################################################################################
# Plot compos(x)
set output "profile_num_compos.ps"
set xrange [-13:13]
set yrange [0.00045:0.00075]
set ylabel "Compos"
plot "profile_num.csv" u ($3-128):2 title "LBM" w p pt 7 ps 1.3 lc rgb "orange", comp(x) title "Analytical" w l lw 3 lc rgb "black3
pause -1
# Plot phi(x)
set output "profile_num_phi.ps"
set xrange [-10:10]
set yrange [0:1]
plot "profile_num.csv" u ($3-128):1  title "LBM" w p pt 6 ps 1.3 lc rgb "blue", phi(x) w l title "Analytical" lw 3 lc rgb "red"
pause -1


